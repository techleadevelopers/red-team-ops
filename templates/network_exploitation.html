
{% extends "base.html" %}

{% block title %}Network Exploitation - APT Red Team{% endblock %}

{% block content %}
<div class="page-container">
    <div class="page-header">
        <h1><i class="fas fa-network-wired"></i> Network Exploitation</h1>
        <p>Advanced network penetration and infrastructure attacks</p>
    </div>

    <div class="attack-modules-grid">
        <!-- Network Discovery -->
        <div class="attack-module">
            <h3><i class="fas fa-search"></i> Network Discovery</h3>
            <p>Discover network topology and active hosts</p>
            <div class="module-controls">
                <input type="text" id="discovery-target" placeholder="192.168.1.0/24" class="input-field">
                <button onclick="executeNetworkDiscovery()" class="btn btn-primary">
                    <i class="fas fa-play"></i> Start Discovery
                </button>
            </div>
        </div>

        <!-- Port Scanning -->
        <div class="attack-module">
            <h3><i class="fas fa-door-open"></i> Port Scanning</h3>
            <p>Advanced port scanning with stealth techniques</p>
            <div class="module-controls">
                <input type="text" id="portscan-target" placeholder="192.168.1.100" class="input-field">
                <select id="scan-type" class="input-field">
                    <option value="stealth">Stealth Scan</option>
                    <option value="connect">Connect Scan</option>
                    <option value="fin">FIN Scan</option>
                    <option value="xmas">XMAS Scan</option>
                    <option value="null">NULL Scan</option>
                </select>
                <button onclick="executePortScan()" class="btn btn-primary">
                    <i class="fas fa-radar"></i> Scan Ports
                </button>
            </div>
        </div>

        <!-- DNS Manipulation -->
        <div class="attack-module">
            <h3><i class="fas fa-server"></i> DNS Manipulation</h3>
            <p>DNS poisoning and hijacking attacks</p>
            <div class="module-controls">
                <input type="text" id="dns-target" placeholder="target.com" class="input-field">
                <select id="dns-attack-type" class="input-field">
                    <option value="poisoning">Cache Poisoning</option>
                    <option value="hijacking">DNS Hijacking</option>
                    <option value="tunneling">DNS Tunneling</option>
                    <option value="amplification">DNS Amplification</option>
                </select>
                <button onclick="executeDNSAttack()" class="btn btn-primary">
                    <i class="fas fa-bug"></i> Attack DNS
                </button>
            </div>
        </div>

        <!-- ARP Spoofing -->
        <div class="attack-module">
            <h3><i class="fas fa-mask"></i> ARP Spoofing</h3>
            <p>Man-in-the-middle attacks via ARP spoofing</p>
            <div class="module-controls">
                <input type="text" id="arp-target" placeholder="192.168.1.0/24" class="input-field">
                <button onclick="executeARPSpoof()" class="btn btn-primary">
                    <i class="fas fa-exchange-alt"></i> Start ARP Spoofing
                </button>
            </div>
        </div>

        <!-- VLAN Hopping -->
        <div class="attack-module">
            <h3><i class="fas fa-sitemap"></i> VLAN Hopping</h3>
            <p>Bypass VLAN segmentation</p>
            <div class="module-controls">
                <input type="text" id="vlan-target" placeholder="192.168.1.1" class="input-field">
                <button onclick="executeVLANHop()" class="btn btn-primary">
                    <i class="fas fa-jump"></i> Hop VLANs
                </button>
            </div>
        </div>
    </div>

    <div class="results-container">
        <h2><i class="fas fa-chart-line"></i> Attack Results</h2>
        <div id="results-display" class="results-display">
            Select an attack module to view results
        </div>
    </div>
</div>

<script>
async function executeNetworkDiscovery() {
    const target = document.getElementById('discovery-target').value || '192.168.1.0/24';
    const resultsDiv = document.getElementById('results-display');
    
    resultsDiv.innerHTML = '<div class="loading">Executing network discovery...</div>';
    
    try {
        const response = await fetch('/api/execute-network-attack', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                attack_type: 'network_discovery',
                target: target
            })
        });
        
        const result = await response.json();
        displayResults(result);
    } catch (error) {
        resultsDiv.innerHTML = `<div class="error">Error: ${error.message}</div>`;
    }
}

async function executePortScan() {
    const target = document.getElementById('portscan-target').value || '192.168.1.100';
    const scanType = document.getElementById('scan-type').value;
    const resultsDiv = document.getElementById('results-display');
    
    resultsDiv.innerHTML = '<div class="loading">Executing port scan...</div>';
    
    try {
        const response = await fetch('/api/execute-network-attack', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                attack_type: 'port_scan',
                targets: [target],
                scan_type: scanType
            })
        });
        
        const result = await response.json();
        displayResults(result);
    } catch (error) {
        resultsDiv.innerHTML = `<div class="error">Error: ${error.message}</div>`;
    }
}

async function executeDNSAttack() {
    const target = document.getElementById('dns-target').value || 'target.com';
    const attackType = document.getElementById('dns-attack-type').value;
    const resultsDiv = document.getElementById('results-display');
    
    resultsDiv.innerHTML = '<div class="loading">Executing DNS attack...</div>';
    
    try {
        const response = await fetch('/api/execute-network-attack', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                attack_type: 'dns_attack',
                target: target,
                dns_type: attackType
            })
        });
        
        const result = await response.json();
        displayResults(result);
    } catch (error) {
        resultsDiv.innerHTML = `<div class="error">Error: ${error.message}</div>`;
    }
}

async function executeARPSpoof() {
    const target = document.getElementById('arp-target').value || '192.168.1.0/24';
    const resultsDiv = document.getElementById('results-display');
    
    resultsDiv.innerHTML = '<div class="loading">Executing ARP spoofing...</div>';
    
    try {
        const response = await fetch('/api/execute-network-attack', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                attack_type: 'arp_spoof',
                target: target
            })
        });
        
        const result = await response.json();
        displayResults(result);
    } catch (error) {
        resultsDiv.innerHTML = `<div class="error">Error: ${error.message}</div>`;
    }
}

async function executeVLANHop() {
    const target = document.getElementById('vlan-target').value || '192.168.1.1';
    const resultsDiv = document.getElementById('results-display');
    
    resultsDiv.innerHTML = '<div class="loading">Executing VLAN hopping...</div>';
    
    try {
        const response = await fetch('/api/execute-network-attack', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                attack_type: 'vlan_hop',
                target: target
            })
        });
        
        const result = await response.json();
        displayResults(result);
    } catch (error) {
        resultsDiv.innerHTML = `<div class="error">Error: ${error.message}</div>`;
    }
}

function displayResults(result) {
    const resultsDiv = document.getElementById('results-display');
    resultsDiv.innerHTML = `
        <div class="result-item">
            <h3>Attack Results</h3>
            <pre>${JSON.stringify(result, null, 2)}</pre>
        </div>
    `;
}
</script>
{% endblock %}
