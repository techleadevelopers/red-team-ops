
{% extends "base.html" %}

{% block content %}
<div class="page-container">
    <div class="page-header">
        <div class="header-icon">
            <i class="fas fa-eye"></i>
        </div>
        <div class="header-content">
            <h1>Threat Intelligence</h1>
            <p>Real-time threat monitoring and intelligence gathering</p>
        </div>
        <div class="header-controls">
            <button class="primary-btn" onclick="refreshIntel()">
                <i class="fas fa-sync-alt"></i> Refresh
            </button>
        </div>
    </div>

    <div class="threat-intel-grid">
        <!-- Threat Overview -->
        <div class="intel-card">
            <div class="card-header">
                <h3><i class="fas fa-globe"></i> Global Threat Landscape</h3>
            </div>
            <div class="threat-overview">
                <div class="threat-level critical">
                    <div class="level-indicator"></div>
                    <div class="level-info">
                        <h4>CRITICAL</h4>
                        <p>Active APT campaigns detected</p>
                    </div>
                </div>
                <div class="threat-stats">
                    <div class="stat">
                        <span class="stat-value">247</span>
                        <span class="stat-label">Active Threats</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value">1,879</span>
                        <span class="stat-label">IOCs Tracked</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value">34</span>
                        <span class="stat-label">New CVEs</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recent CVEs -->
        <div class="intel-card">
            <div class="card-header">
                <h3><i class="fas fa-shield-alt"></i> Latest CVEs</h3>
                <span class="update-time">Last updated: 2 min ago</span>
            </div>
            <div class="cve-list">
                <div class="cve-item critical">
                    <div class="cve-header">
                        <span class="cve-id">CVE-2024-1234</span>
                        <span class="cve-score">9.8</span>
                    </div>
                    <p class="cve-description">Remote Code Execution in Apache HTTP Server</p>
                    <div class="cve-tags">
                        <span class="tag">RCE</span>
                        <span class="tag">Network</span>
                        <span class="tag">Apache</span>
                    </div>
                </div>
                <div class="cve-item high">
                    <div class="cve-header">
                        <span class="cve-id">CVE-2024-5678</span>
                        <span class="cve-score">8.7</span>
                    </div>
                    <p class="cve-description">Privilege Escalation in Windows Kernel</p>
                    <div class="cve-tags">
                        <span class="tag">PrivEsc</span>
                        <span class="tag">Windows</span>
                        <span class="tag">Kernel</span>
                    </div>
                </div>
                <div class="cve-item medium">
                    <div class="cve-header">
                        <span class="cve-id">CVE-2024-9012</span>
                        <span class="cve-score">7.5</span>
                    </div>
                    <p class="cve-description">SQL Injection in WordPress Plugin</p>
                    <div class="cve-tags">
                        <span class="tag">SQLi</span>
                        <span class="tag">WordPress</span>
                        <span class="tag">Plugin</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- APT Groups -->
        <div class="intel-card">
            <div class="card-header">
                <h3><i class="fas fa-users"></i> Active APT Groups</h3>
            </div>
            <div class="apt-groups">
                <div class="apt-group">
                    <div class="apt-header">
                        <h4>APT29 (Cozy Bear)</h4>
                        <span class="activity-level high">High Activity</span>
                    </div>
                    <p>Russian state-sponsored group targeting government entities</p>
                    <div class="apt-stats">
                        <span>12 new IOCs</span>
                        <span>3 campaigns</span>
                        <span>Government targets</span>
                    </div>
                </div>
                <div class="apt-group">
                    <div class="apt-header">
                        <h4>Lazarus Group</h4>
                        <span class="activity-level medium">Medium Activity</span>
                    </div>
                    <p>North Korean group focusing on financial institutions</p>
                    <div class="apt-stats">
                        <span>8 new IOCs</span>
                        <span>2 campaigns</span>
                        <span>Financial targets</span>
                    </div>
                </div>
                <div class="apt-group">
                    <div class="apt-header">
                        <h4>FIN7</h4>
                        <span class="activity-level low">Low Activity</span>
                    </div>
                    <p>Financially motivated group targeting retail and hospitality</p>
                    <div class="apt-stats">
                        <span>3 new IOCs</span>
                        <span>1 campaign</span>
                        <span>Retail targets</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Malware Families -->
        <div class="intel-card">
            <div class="card-header">
                <h3><i class="fas fa-virus"></i> Trending Malware</h3>
            </div>
            <div class="malware-list">
                <div class="malware-item">
                    <div class="malware-info">
                        <h4>RedLine Stealer</h4>
                        <p>Information stealer targeting credentials and crypto wallets</p>
                    </div>
                    <div class="malware-stats">
                        <span class="trend up">+23%</span>
                        <span class="samples">1,247 samples</span>
                    </div>
                </div>
                <div class="malware-item">
                    <div class="malware-info">
                        <h4>Qakbot</h4>
                        <p>Banking trojan with extensive backdoor capabilities</p>
                    </div>
                    <div class="malware-stats">
                        <span class="trend up">+18%</span>
                        <span class="samples">892 samples</span>
                    </div>
                </div>
                <div class="malware-item">
                    <div class="malware-info">
                        <h4>IcedID</h4>
                        <p>Modular banking trojan with persistence mechanisms</p>
                    </div>
                    <div class="malware-stats">
                        <span class="trend down">-7%</span>
                        <span class="samples">634 samples</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- IOC Feed -->
        <div class="intel-card ioc-card">
            <div class="card-header">
                <h3><i class="fas fa-fingerprint"></i> Indicators of Compromise</h3>
                <div class="ioc-controls">
                    <select class="ioc-filter" onchange="filterIOCs(this.value)">
                        <option value="all">All IOCs</option>
                        <option value="ip">IP Addresses</option>
                        <option value="domain">Domains</option>
                        <option value="hash">File Hashes</option>
                        <option value="url">URLs</option>
                    </select>
                </div>
            </div>
            <div class="ioc-feed" id="ioc-feed">
                <div class="ioc-item">
                    <div class="ioc-type ip">IP</div>
                    <div class="ioc-value">192.168.1.100</div>
                    <div class="ioc-threat">APT29 C2</div>
                    <div class="ioc-confidence high">High</div>
                </div>
                <div class="ioc-item">
                    <div class="ioc-type domain">Domain</div>
                    <div class="ioc-value">malicious-domain.com</div>
                    <div class="ioc-threat">RedLine C2</div>
                    <div class="ioc-confidence medium">Medium</div>
                </div>
                <div class="ioc-item">
                    <div class="ioc-type hash">SHA256</div>
                    <div class="ioc-value">a1b2c3d4e5f6789...</div>
                    <div class="ioc-threat">Qakbot Sample</div>
                    <div class="ioc-confidence high">High</div>
                </div>
                <div class="ioc-item">
                    <div class="ioc-type url">URL</div>
                    <div class="ioc-value">https://phishing-site.net/login</div>
                    <div class="ioc-threat">Phishing</div>
                    <div class="ioc-confidence low">Low</div>
                </div>
            </div>
        </div>

        <!-- Threat Map -->
        <div class="intel-card map-card">
            <div class="card-header">
                <h3><i class="fas fa-map"></i> Global Threat Map</h3>
            </div>
            <div class="threat-map">
                <div class="map-region" data-region="north-america">
                    <div class="region-name">North America</div>
                    <div class="threat-count">247 threats</div>
                </div>
                <div class="map-region" data-region="europe">
                    <div class="region-name">Europe</div>
                    <div class="threat-count">189 threats</div>
                </div>
                <div class="map-region" data-region="asia">
                    <div class="region-name">Asia-Pacific</div>
                    <div class="threat-count">324 threats</div>
                </div>
                <div class="map-region" data-region="others">
                    <div class="region-name">Others</div>
                    <div class="threat-count">98 threats</div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function refreshIntel() {
    // Simulate data refresh
    console.log('Refreshing threat intelligence data...');
}

function filterIOCs(type) {
    const iocItems = document.querySelectorAll('.ioc-item');
    iocItems.forEach(item => {
        if (type === 'all' || item.querySelector('.ioc-type').textContent.toLowerCase().includes(type)) {
            item.style.display = 'grid';
        } else {
            item.style.display = 'none';
        }
    });
}
</script>
{% endblock %}
